┌──────────────────────────────────────────────────────────────────────┐
│                      APPLICATION LAYER                               │


│  Your training script                                                │


│      │                                                               │


│      ▼                                                               │


│  PyTorch 2.1.2  ◄─── Compiled against specific CUDA version          │


│      │                                                               │


│      ├──────────────────────────────────────────┐                    │


│      ▼                                          ▼                    │


│  torch.cuda module                         cuDNN bindings            │


└──────────────────────────────────────────────────────────────────────┘


                         │                         │


                         ▼                         ▼


┌──────────────────────────────────────────────────────────────────────┐


│                      RUNTIME LAYER                                   │


│  CUDA Runtime (libcudart.so.12)          cuDNN 8.9 (libcudnn.so.8)   │


│      │                                          │                    │


│      └───────────────────┬──────────────────────┘                    │


│                          ▼                                           │


│                   CUDA Driver API                                    │


└──────────────────────────────────────────────────────────────────────┘


                          │


                          ▼


┌──────────────────────────────────────────────────────────────────────┐


│                      DRIVER LAYER                                    │


│  NVIDIA Kernel Module (nvidia.ko)                                    │


│      │                                                               │


│      └──── Compiled against specific kernel version (DKMS)           │


└──────────────────────────────────────────────────────────────────────┘


                          │


                          ▼


┌──────────────────────────────────────────────────────────────────────┐


│                      KERNEL LAYER                                    │


│  Linux Kernel 6.5.0 ◄─── Module interface version                    │


│      │                                                               │


│      └──── Kernel headers (required for DKMS builds)                 │


└──────────────────────────────────────────────────────────────────────┘